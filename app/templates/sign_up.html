{% extends "base.html" %}
{% block content %}
    <script type="text/javascript">
        var username = $('#username').val();
        $('#username').change(function() {
            $("#username_error_msg").val("")
            $.ajax({
              url: "/check_username",
              type: 'POST',
              data: 'username=' + username,
              done: function(result){ //Returns the number of users with the given username
                         if(parseInt(result)){
                             $("#username_error_msg").val("Sorry! The name '" + username + "' is already taken.")
                             $("#username").val("");
                         }
                         else{
                             $("#username_error_msg").val("")
                         }
                       }
              });
        });
    </script>

<h1>Please provide some information:</h1>
<p>
    (items with a <span class="text-primary">*</span> are required)
</p>

    <form id="register_form" action="" method="post" name="register">
        {{form.hidden_tag()}}
        <p>
            {{form.username.label}}<span class="text-primary">*</span>
            {{form.username(size=20, maxlength=256)}}
            <span id="username_error_msg" class="text-danger" style="display:none"></span>
            {% for error in form.errors.username %}
                <span class="text-danger">[{{error}}]</span><br>
            {% endfor %}
        </p>

        <p>
            {{form.email.label}}<span class="text-primary">*</span>
            {{form.email(size=20, maxlength=256)}}
            <span id="email_error_msg" class="text-danger" style="display:none"></span>
            {% for error in form.errors.email %}
                <span class="text-danger">[{{error}}]</span><br>
            {% endfor %}
        </p>

        <p>
            {{form.password.label}}<span class="text-primary">*</span>
            {{form.password(size=20, maxlength=256)}}
            {% for error in form.errors.password %}
                <span class="text-danger">[{{error}}]</span><br>
            {% endfor %}
        </p>

        <p>
            <p>
                {{form.confirm_password.label}}<span class="text-primary">*</span>
                {{form.confirm_password(size=20, maxlength=256)}}
                {% for error in form.errors.confirm_password %}
                    <span class="text-danger">[{{error}}]</span><br>
                {% endfor %}
            </p>
        </p>

        <p>
            <p>
                {{form.age.label}}
                {{form.age(size=2)}}
                {% for error in form.errors.age %}
                    <span class="text-danger">[{{error}}]</span><br>
                {% endfor %}
            </p>
        </p>

        <p>
            <p>
                {{form.gender.label}}
                {{form.gender(size=12, maxlength=24)}}
                {% for error in form.errors.gender %}
                    <span class="text-danger">[{{error}}]</span><br>
                {% endfor %}
            </p>
        </p>

        <p>
            <p>
                {{form.role.label}}
                {{form.role(size=12, maxlength=24)}}
                {% for error in form.errors.role %}
                    <span class="text-danger">[{{error}}]</span><br>
                {% endfor %}
            </p>
        </p>

        <p>
            <p>
                {{form.orientation.label}}
                {{form.orientation(size=12, maxlength=24)}}
                {% for error in form.errors.orientation %}
                    <span class="text-danger">[{{error}}]</span><br>
                {% endfor %}
            </p>
        </p>

        <p>
            <p>
                {{form.bio.label}}
                {{form.bio(cols=48, rows=12)}}
                {% for error in form.errors.bio %}
                    <span class="text-danger">[{{error}}]</span><br>
                {% endfor %}
            </p>
        </p>

        <p>
            {{form.remember_me.label}}
            {{form.remember_me}}
        </p>


        <input type="submit" name="log_in" value="Register Me">
    </form>
{% endblock %}
